<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Veridian Â· Commodity Hedging Intelligence Platform</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{
  --teal:#0D9488; --teal-l:#14B8A6; --teal-xl:#5EEAD4; --teal-dim:#CCFBF1; --teal-bg:#F0FDFA;
  --teal-glow:rgba(13,148,136,.09); --teal-card:rgba(13,148,136,.06);
  --ink:#0A1A18; --ink-mid:#1E3A36; --ink-soft:#4A6B67; --ink-faint:#8FADA9; --ink-ghost:#C5DAD8;
  --surface:#FFFFFF; --surface-alt:#F8FFFE; --border:rgba(13,148,136,.14); --border-m:rgba(13,148,136,.26);
  --green:#10B981; --amber:#F59E0B; --red:#EF4444; --blue:#3B82F6; --purple:#8B5CF6;
  --r8:8px; --r12:12px; --r16:16px; --r20:20px;
  --shadow-s:0 1px 3px rgba(0,0,0,.04),0 4px 12px rgba(13,148,136,.07);
  --shadow-m:0 2px 8px rgba(0,0,0,.06),0 12px 32px rgba(13,148,136,.10);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--teal-bg);color:var(--ink);font-size:14px;height:100vh;overflow:hidden;display:flex}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-thumb{background:var(--teal-dim);border-radius:2px}

/* â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#sidebar{width:232px;min-width:232px;background:var(--ink);display:flex;flex-direction:column;position:relative;overflow:hidden;z-index:20}
#sidebar::before{content:'';position:absolute;top:-80px;right:-80px;width:240px;height:240px;background:radial-gradient(circle,rgba(13,148,136,.18) 0%,transparent 70%);pointer-events:none}
.sb-logo{padding:22px 18px 16px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:10px}
.sb-logo-icon{width:34px;height:34px;background:linear-gradient(135deg,var(--teal),var(--teal-l));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;box-shadow:0 4px 14px rgba(13,148,136,.45);flex-shrink:0}
.sb-brand-main{font-family:'DM Serif Display';font-size:15px;color:#fff;line-height:1;letter-spacing:-.01em}
.sb-brand-sub{font-size:9px;color:var(--teal-l);letter-spacing:.14em;text-transform:uppercase;margin-top:2px}
.sb-section{font-size:9px;color:rgba(255,255,255,.25);letter-spacing:.12em;text-transform:uppercase;padding:16px 18px 6px}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 14px;margin:1px 8px;border-radius:10px;cursor:pointer;transition:.15s;color:rgba(255,255,255,.4);font-size:12.5px;font-weight:400;border-left:2px solid transparent;position:relative}
.nav-item:hover{background:rgba(255,255,255,.05);color:rgba(255,255,255,.65)}
.nav-item.active{background:rgba(13,148,136,.2);color:var(--teal-l);font-weight:600;border-left-color:var(--teal)}
.nav-icon{font-size:14px;width:20px;text-align:center}
.nav-badge{margin-left:auto;background:var(--red);color:#fff;font-size:9px;font-weight:700;padding:2px 6px;border-radius:20px}
.nav-badge.green{background:var(--green)}
.nav-badge.amber{background:var(--amber);color:var(--ink)}
.commodity-list{padding:4px 8px;max-height:180px;overflow-y:auto}
.comm-item{display:flex;align-items:center;justify-content:space-between;padding:7px 10px;border-radius:8px;cursor:pointer;transition:.15s}
.comm-item:hover{background:rgba(255,255,255,.05)}
.comm-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.comm-name{font-size:11px;color:rgba(255,255,255,.45);margin-left:8px;flex:1}
.comm-cov{font-family:'JetBrains Mono';font-size:10px;font-weight:600}
.sb-bottom{padding:14px 18px;border-top:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:10px;margin-top:auto}
.avatar{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,var(--teal),var(--teal-l));display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff;flex-shrink:0}
.user-name{font-size:11px;color:rgba(255,255,255,.65);font-weight:600}
.user-role{font-size:10px;color:rgba(255,255,255,.3)}

/* â”€â”€ MAIN CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#main{flex:1;display:flex;flex-direction:column;overflow:hidden}
#topbar{height:54px;background:rgba(255,255,255,.88);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 24px;gap:14px;z-index:10;flex-shrink:0}
.search-bar{flex:1;max-width:340px;display:flex;align-items:center;gap:8px;background:var(--teal-glow);border:1px solid var(--border);border-radius:10px;padding:7px 14px;cursor:text}
.search-bar span{font-size:12px;color:var(--ink-faint)}
.live-pill{display:flex;align-items:center;gap:6px;padding:5px 12px;background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.22);border-radius:8px}
.live-dot{width:6px;height:6px;border-radius:50%;background:var(--green);animation:pulse-g 2s infinite}
@keyframes pulse-g{0%,100%{box-shadow:0 0 0 0 rgba(16,185,129,.5)}50%{box-shadow:0 0 0 6px rgba(16,185,129,0)}}
.live-txt{font-size:11px;color:var(--green);font-weight:600}
.topbar-chip{display:flex;align-items:center;gap:5px;padding:5px 12px;background:var(--surface);border:1px solid var(--border);border-radius:8px;font-size:11px;color:var(--ink-soft);font-family:'JetBrains Mono';font-weight:500}
#content{flex:1;overflow:auto;padding:22px 24px}

/* â”€â”€ VIEWS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.view{display:none;animation:fadeUp .38s ease both}
.view.active{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€ CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r16);box-shadow:var(--shadow-s);transition:.2s}
.card:hover{box-shadow:var(--shadow-m)}
.card-header{padding:18px 22px 14px;border-bottom:1px solid var(--border)}
.card-title{font-family:'DM Serif Display';font-size:16px;color:var(--ink);line-height:1.2}
.card-sub{font-size:11px;color:var(--ink-soft);margin-top:3px}

/* â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn{font-family:'DM Sans';font-size:13px;font-weight:600;padding:9px 18px;border-radius:10px;border:none;cursor:pointer;transition:.18s;letter-spacing:.01em}
.btn-p{background:var(--teal);color:#fff;box-shadow:0 2px 8px rgba(13,148,136,.3)}
.btn-p:hover{background:var(--teal-l);transform:translateY(-1px);box-shadow:0 4px 14px rgba(13,148,136,.4)}
.btn-g{background:transparent;color:var(--teal);border:1px solid var(--border-m)}
.btn-g:hover{background:var(--teal-glow)}
.btn-sm{padding:6px 13px;font-size:11px;border-radius:8px}

/* â”€â”€ BADGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:6px;font-size:11px;font-weight:600;letter-spacing:.03em}
.badge-buy{background:rgba(16,185,129,.1);color:var(--green);border:1px solid rgba(16,185,129,.25)}
.badge-hold{background:rgba(245,158,11,.1);color:var(--amber);border:1px solid rgba(245,158,11,.25)}
.badge-sell{background:rgba(239,68,68,.1);color:var(--red);border:1px solid rgba(239,68,68,.22)}
.badge-teal{background:rgba(13,148,136,.1);color:var(--teal);border:1px solid rgba(13,148,136,.22)}
.badge-blue{background:rgba(59,130,246,.1);color:var(--blue);border:1px solid rgba(59,130,246,.22)}
.badge-purple{background:rgba(139,92,246,.1);color:var(--purple);border:1px solid rgba(139,92,246,.22)}
.badge-amber{background:rgba(245,158,11,.1);color:var(--amber);border:1px solid rgba(245,158,11,.25)}
.badge-red{background:rgba(239,68,68,.1);color:var(--red);border:1px solid rgba(239,68,68,.22)}

/* â”€â”€ GRIDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
.g-main{display:grid;grid-template-columns:1fr 320px;gap:16px}
.g-main-l{display:grid;grid-template-columns:280px 1fr;gap:16px}

/* â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.prog-bar{height:5px;background:var(--teal-dim);border-radius:3px;overflow:hidden}
.prog-fill{height:100%;border-radius:3px;transition:width 1s ease}
.prog-row{display:flex;align-items:center;gap:10px}
.prog-label{font-size:11px;color:var(--ink-soft);min-width:110px}
.prog-val{font-family:'JetBrains Mono';font-size:11px;font-weight:600;min-width:32px;text-align:right}

/* â”€â”€ STAT CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.kpi-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r16);padding:18px 20px;box-shadow:var(--shadow-s)}
.kpi-label{font-size:11px;color:var(--ink-soft);margin-bottom:8px}
.kpi-val{font-family:'DM Serif Display';font-size:26px;color:var(--ink);line-height:1}
.kpi-sub{font-size:10px;color:var(--ink-faint);margin-top:5px}
.kpi-icon{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px}

/* â”€â”€ TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.tbl-row{display:grid;align-items:center;padding:13px 22px;border-bottom:1px solid var(--border);cursor:pointer;transition:.15s}
.tbl-row:hover{background:var(--teal-glow)}
.tbl-row:last-child{border-bottom:none}
.tbl-head{display:grid;align-items:center;padding:10px 22px;border-bottom:1px solid var(--border);background:var(--surface-alt)}
.tbl-head span{font-size:10px;color:var(--ink-faint);letter-spacing:.06em;text-transform:uppercase;font-weight:600}

/* â”€â”€ SCORE RING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.ring-wrap{position:relative;display:inline-flex;align-items:center;justify-content:center}
.ring-inner{position:absolute;text-align:center}
.ring-val{font-family:'DM Serif Display';font-size:22px;color:var(--ink);line-height:1}
.ring-lbl{font-size:9px;color:var(--ink-faint);letter-spacing:.06em;text-transform:uppercase;margin-top:1px}

/* â”€â”€ HERO BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero{background:linear-gradient(135deg,var(--ink) 0%,#1A3835 55%,#0D2E2B 100%);border-radius:20px;padding:28px 32px;margin-bottom:20px;position:relative;overflow:hidden}
.hero::after{content:'';position:absolute;top:-70px;right:-70px;width:280px;height:280px;background:radial-gradient(circle,rgba(13,148,136,.22) 0%,transparent 70%);pointer-events:none}
.hero::before{content:'';position:absolute;bottom:-40px;left:38%;width:200px;height:200px;background:radial-gradient(circle,rgba(20,184,166,.12) 0%,transparent 70%);pointer-events:none}
.hero-content{position:relative}
.hero-eyebrow{font-size:11px;color:var(--teal-l);font-weight:600;letter-spacing:.1em;text-transform:uppercase;margin-bottom:8px}
.hero-title{font-family:'DM Serif Display';font-size:28px;color:#fff;line-height:1.2;margin-bottom:6px}
.hero-sub{font-size:13px;color:rgba(255,255,255,.45);line-height:1.6}
.hero-actions{display:flex;gap:10px;margin-top:18px}
.hero-stat{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px 16px;text-align:center}
.hero-stat-val{font-family:'DM Serif Display';font-size:22px;color:#fff;line-height:1}
.hero-stat-lbl{font-size:10px;color:rgba(255,255,255,.4);margin-top:3px;letter-spacing:.04em}

/* â”€â”€ SIGNALS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.signal-item{padding:13px 18px;border-bottom:1px solid var(--border);cursor:pointer;transition:.15s}
.signal-item:hover{background:var(--teal-glow)}
.signal-type{font-size:9px;font-weight:700;letter-spacing:.1em;text-transform:uppercase}
.signal-text{font-size:12px;color:var(--ink-mid);line-height:1.5;margin:4px 0}

/* â”€â”€ BIAS RADAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bias-chip{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-radius:10px;border:1px solid var(--border);margin-bottom:8px;transition:.15s}
.bias-chip:hover{border-color:var(--border-m);background:var(--teal-glow)}
.bias-name{font-size:12px;font-weight:600;color:var(--ink)}
.bias-level{font-family:'JetBrains Mono';font-size:12px;font-weight:600}

/* â”€â”€ GENOME TREE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.gene-product{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px 16px;margin-bottom:10px;cursor:pointer;transition:.2s}
.gene-product.open{border-color:var(--teal);box-shadow:0 0 0 3px rgba(13,148,136,.08)}
.gene-product-name{font-weight:600;font-size:13px;color:var(--ink)}
.gene-ingredients{padding:10px 0 0 18px;display:none}
.gene-ingredients.open{display:block}
.gene-ing{display:flex;align-items:center;gap:10px;padding:7px 0;border-left:2px solid var(--teal-dim)}
.gene-ing-name{font-size:12px;color:var(--ink-mid);padding-left:10px;flex:1}
.gene-ing-bar{flex:1;height:4px;background:var(--teal-dim);border-radius:2px;overflow:hidden;max-width:80px}
.gene-ing-fill{height:100%;background:var(--teal);border-radius:2px}
.gene-comm{display:flex;align-items:center;gap:8px;padding:5px 10px;border-radius:8px;background:var(--teal-glow);margin:4px 0 4px 20px}

/* â”€â”€ SCENARIO SLIDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.scenario-card{border:1px solid var(--border);border-radius:12px;padding:13px 16px;cursor:pointer;transition:.2s;margin-bottom:8px}
.scenario-card.active{border-color:var(--teal);background:var(--teal-glow)}
.scenario-title{font-weight:600;font-size:13px;color:var(--ink)}
.scenario-desc{font-size:11px;color:var(--ink-soft);margin-top:3px}
input[type=range]{width:100%;accent-color:var(--teal);cursor:pointer;height:4px;border-radius:2px}

/* â”€â”€ TRIGGER WINDOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.trigger-active{background:linear-gradient(135deg,rgba(16,185,129,.06),rgba(13,148,136,.06));border:1px solid rgba(16,185,129,.3);border-radius:12px;padding:14px 16px;animation:trigger-glow 2.5s ease-in-out infinite}
@keyframes trigger-glow{0%,100%{box-shadow:0 0 0 0 rgba(16,185,129,.3)}50%{box-shadow:0 0 12px 2px rgba(16,185,129,.15)}}
.trigger-closed{background:rgba(239,68,68,.04);border:1px solid rgba(239,68,68,.2);border-radius:12px;padding:14px 16px}

/* â”€â”€ PROFILE SCORE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.score-section{padding:18px 22px}
.score-grade{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:700;letter-spacing:.04em}
.grade-a{background:rgba(16,185,129,.12);color:var(--green);border:1px solid rgba(16,185,129,.3)}
.grade-b{background:rgba(13,148,136,.12);color:var(--teal);border:1px solid rgba(13,148,136,.3)}
.grade-c{background:rgba(245,158,11,.12);color:var(--amber);border:1px solid rgba(245,158,11,.3)}
.grade-d{background:rgba(239,68,68,.12);color:var(--red);border:1px solid rgba(239,68,68,.3)}

/* â”€â”€ PEER BENCHMARK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bench-row{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--border)}
.bench-label{font-size:12px;color:var(--ink-soft);min-width:90px}
.bench-bar-wrap{flex:1;height:8px;background:var(--teal-dim);border-radius:4px;position:relative;overflow:visible}
.bench-bar-you{height:8px;background:var(--teal);border-radius:4px;position:relative;z-index:2;transition:width 1s ease}
.bench-bar-peer{position:absolute;top:0;height:8px;background:var(--ink-ghost);border-radius:4px;opacity:.5}
.bench-marker{position:absolute;top:-4px;width:2px;height:16px;background:var(--ink-soft);border-radius:1px;z-index:3}
.bench-you-val{font-family:'JetBrains Mono';font-size:12px;font-weight:700;color:var(--teal);min-width:36px;text-align:right}
.bench-peer-val{font-family:'JetBrains Mono';font-size:11px;color:var(--ink-faint);min-width:36px;text-align:right}

/* â”€â”€ REGRET ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.decision-row{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid var(--border);align-items:center}
.decision-icon{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
.decision-win{background:rgba(16,185,129,.12)}
.decision-loss{background:rgba(239,68,68,.12)}
.regret-amount{font-family:'JetBrains Mono';font-size:13px;font-weight:600}

/* â”€â”€ SYNTHETIC HEDGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.synth-component{display:flex;align-items:center;gap:12px;padding:10px 14px;border:1px solid var(--border);border-radius:10px;margin-bottom:8px}
.synth-weight{font-family:'JetBrains Mono';font-size:16px;font-weight:600;color:var(--teal);min-width:44px}
.synth-name{font-size:13px;font-weight:600;color:var(--ink)}
.synth-detail{font-size:11px;color:var(--ink-soft)}

/* â”€â”€ CARBON OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.carbon-chip{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-radius:10px;border:1px solid var(--border);margin-bottom:8px}
.carbon-val{font-family:'JetBrains Mono';font-size:13px;font-weight:600}
.carbon-impact{font-size:11px;font-weight:600;padding:2px 7px;border-radius:5px}

/* â”€â”€ ORACLE LOADING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#oracle-loading{text-align:center;padding:60px 20px}
#oracle-results{display:none}
.oracle-step{display:flex;align-items:center;gap:12px;padding:8px 0;font-size:12px;transition:.3s}
.step-icon{width:20px;text-align:center;font-size:14px}
.step-bar{flex:1;height:3px;background:var(--teal-dim);border-radius:2px;overflow:hidden}
.step-fill{height:100%;background:var(--teal);width:0;border-radius:2px;transition:width .8s ease}

/* â”€â”€ DIFFERENTIATOR BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.diff-banner{background:linear-gradient(90deg,rgba(13,148,136,.08),rgba(20,184,166,.04));border:1px solid var(--border-m);border-radius:12px;padding:12px 16px;display:flex;align-items:flex-start;gap:10px;margin-top:16px}
.diff-icon{font-size:16px;flex-shrink:0}
.diff-title{font-size:12px;font-weight:700;color:var(--teal);margin-bottom:2px}
.diff-text{font-size:11px;color:var(--ink-soft);line-height:1.55}

/* â”€â”€ FLOAT ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
.float{animation:float 3s ease-in-out infinite}
@keyframes spin-slow{to{transform:rotate(360deg)}}

/* â”€â”€ PAGE TITLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.page-title-row{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px}
.page-title{font-family:'DM Serif Display';font-size:24px;color:var(--ink);line-height:1.15}
.page-sub{font-size:12px;color:var(--ink-soft);margin-top:3px}

/* â”€â”€ WATERFALL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.waterfall-bar{display:flex;align-items:flex-end;gap:4px;height:120px;margin:16px 0}
.wf-col{display:flex;flex-direction:column;align-items:center;flex:1;gap:3px}
.wf-bar{width:100%;border-radius:4px 4px 0 0;transition:height 1s ease}
.wf-label{font-size:9px;color:var(--ink-faint);text-align:center;letter-spacing:.03em}
.wf-val{font-family:'JetBrains Mono';font-size:10px;font-weight:600}

/* â”€â”€ HOVER REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.tooltip-wrap{position:relative;cursor:help}
.tooltip-box{position:absolute;bottom:120%;left:50%;transform:translateX(-50%);background:var(--ink);color:#fff;font-size:11px;padding:6px 10px;border-radius:8px;white-space:nowrap;opacity:0;pointer-events:none;transition:.15s;z-index:100}
.tooltip-wrap:hover .tooltip-box{opacity:1}

/* scrollable view */
#content{scroll-behavior:smooth}
</style>
</head>
<body>

<!-- â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside id="sidebar">
  <div class="sb-logo">
    <div class="sb-logo-icon">â—ˆ</div>
    <div>
      <div class="sb-brand-main">Veridian</div>
      <div class="sb-brand-sub">Hedge Intelligence</div>
    </div>
  </div>

  <div class="sb-section">Platform</div>
  <div class="nav-item active" onclick="showView('dashboard')">
    <span class="nav-icon">â¬¡</span> Command Center
    <span class="nav-badge amber">3</span>
  </div>
  <div class="nav-item" onclick="showView('profiles')">
    <span class="nav-icon">â—</span> Scoring Profiles
    <span class="nav-badge green">NEW</span>
  </div>
  <div class="nav-item" onclick="showView('oracle')">
    <span class="nav-icon">âš¡</span> ORACLE Engine
  </div>
  <div class="nav-item" onclick="showView('genome')">
    <span class="nav-icon">ğŸ§¬</span> Commodity DNA
  </div>
  <div class="nav-item" onclick="showView('scenarios')">
    <span class="nav-icon">â—ˆ</span> Scenario Engine
  </div>
  <div class="nav-item" onclick="showView('signals')">
    <span class="nav-icon">âŠ•</span> Signal Lab
    <span class="nav-badge" style="background:var(--red)">5</span>
  </div>

  <div class="sb-section">Portfolio</div>
  <div class="commodity-list" id="sb-comm-list"></div>

  <div class="sb-bottom">
    <div class="avatar">S</div>
    <div>
      <div class="user-name">Sarah Chen</div>
      <div class="user-role">VP Procurement Â· CPG</div>
    </div>
  </div>
</aside>

<!-- â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="main">
  <!-- TOPBAR -->
  <div id="topbar">
    <div class="search-bar">
      <span style="color:var(--teal);font-size:13px">â—ˆ</span>
      <span>Ask AI â€” "Why is Ethylene at 78%?"</span>
    </div>
    <div style="flex:1"></div>
    <div class="live-pill"><div class="live-dot"></div><span class="live-txt">50 Signals Live</span></div>
    <div class="topbar-chip">ğŸ• CRM Session Â· 23 Feb 2026</div>
    <div class="topbar-chip" style="color:var(--teal)">IFRS 9 âœ“</div>
    <button class="btn btn-p btn-sm" onclick="showView('oracle')">âš¡ Run AI</button>
  </div>

  <div id="content">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 1: COMMAND CENTER / DASHBOARD                                      -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view active" id="view-dashboard">
    <!-- Hero -->
    <div class="hero">
      <div class="hero-content">
        <div style="display:flex;justify-content:space-between;align-items:flex-start">
          <div style="flex:1">
            <div class="hero-eyebrow">Monday Â· 23 Feb 2026 Â· Q1 Hedging Cycle</div>
            <div class="hero-title">Good morning, Sarah.<br><span style="color:var(--teal-l)">3 commodities</span> need action today.</div>
            <div class="hero-sub">AI auto-tuned 4 parameter sets overnight Â· Ethylene coverage reco +7% Â· Proxy hedge discovered for Propylene</div>
            <div class="hero-actions">
              <button class="btn btn-p" onclick="showView('oracle')">âš¡ Run AI Recommendations</button>
              <button class="btn btn-g" style="color:rgba(255,255,255,.6);border-color:rgba(255,255,255,.15)" onclick="showView('scenarios')">â—ˆ Scenario Engine</button>
              <button class="btn btn-g" style="color:rgba(255,255,255,.6);border-color:rgba(255,255,255,.15)" onclick="showView('profiles')">â— View Scores</button>
            </div>
          </div>
          <div style="display:flex;gap:12px;margin-left:24px">
            <div class="hero-stat">
              <div class="hero-stat-val" id="phs-hero">84</div>
              <div class="hero-stat-lbl">Health Score</div>
            </div>
            <div class="hero-stat">
              <div class="hero-stat-val">+Â£4.3M</div>
              <div class="hero-stat-lbl">YTD M2M</div>
            </div>
            <div class="hero-stat">
              <div class="hero-stat-val">77%</div>
              <div class="hero-stat-lbl">Avg Coverage</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- KPI row -->
    <div class="g4" style="margin-bottom:18px">
      <div class="kpi-card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
          <div class="kpi-label">Total Hedged Exposure</div>
          <div class="kpi-icon" style="background:rgba(13,148,136,.1)">â—ˆ</div>
        </div>
        <div class="kpi-val">Â£144.2M</div>
        <div class="kpi-sub">6 commodities Â· 10 instruments</div>
      </div>
      <div class="kpi-card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
          <div class="kpi-label">M2M Performance YTD</div>
          <div class="kpi-icon" style="background:rgba(16,185,129,.1);color:var(--green)">â†‘</div>
        </div>
        <div class="kpi-val" style="color:var(--green)">+Â£4.39M</div>
        <div class="kpi-sub">vs. avg spot Â· 77% of max possible M2M</div>
      </div>
      <div class="kpi-card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
          <div class="kpi-label">Decision Quality Score</div>
          <div class="kpi-icon" style="background:rgba(59,130,246,.1);color:var(--blue)">âŠ•</div>
        </div>
        <div class="kpi-val" style="color:var(--blue)">71%</div>
        <div class="kpi-sub">When overriding AI Â· 3 poor calls in 12mo</div>
      </div>
      <div class="kpi-card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
          <div class="kpi-label">IFRS 9 Compliance</div>
          <div class="kpi-icon" style="background:rgba(139,92,246,.1);color:var(--purple)">âœ“</div>
        </div>
        <div class="kpi-val" style="color:var(--purple)">97%</div>
        <div class="kpi-sub">Hedge effectiveness Â· Auto-tested daily</div>
      </div>
    </div>

    <!-- Main table + signals -->
    <div class="g-main">
      <div class="card" style="padding:0;overflow:hidden">
        <div class="card-header" style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="card-title">Commodity Portfolio</div>
            <div class="card-sub">Live coverage Â· AI signals Â· Criticality scores</div>
          </div>
          <div style="display:flex;gap:6px">
            <button class="btn btn-g btn-sm">All</button>
            <button class="btn btn-g btn-sm">Dairy</button>
            <button class="btn btn-g btn-sm">Petrochem</button>
          </div>
        </div>
        <div class="tbl-head" style="grid-template-columns:160px 90px 70px 80px 80px 70px 60px">
          <span>Commodity</span><span>Price</span><span>Î”</span><span>Signal</span><span>Coverage</span><span>M2M</span><span>Priority</span>
        </div>
        <div id="comm-table"></div>
      </div>

      <!-- Signal feed -->
      <div class="card" style="padding:0;overflow:hidden;display:flex;flex-direction:column">
        <div class="card-header">
          <div class="card-title">Live Signal Feed</div>
          <div class="card-sub">50+ alt-data streams Â· Intraday triggers</div>
        </div>
        <div style="flex:1;overflow:auto" id="signal-feed"></div>
        <div style="padding:10px 16px;border-top:1px solid var(--border)">
          <button class="btn btn-g btn-sm" style="width:100%" onclick="showView('signals')">View Signal Lab â†’</button>
        </div>
      </div>
    </div>

    <!-- Active trigger windows -->
    <div style="margin-top:16px">
      <div style="font-size:13px;font-weight:600;color:var(--ink);margin-bottom:10px">âš¡ Active Trigger Windows</div>
      <div class="g3">
        <div class="trigger-active">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">
            <div style="font-size:12px;font-weight:700;color:var(--green)">ğŸŸ¢ WINDOW OPEN</div>
            <div style="font-size:10px;color:var(--ink-soft)">Opened 2h ago</div>
          </div>
          <div style="font-size:14px;font-weight:700;color:var(--ink);margin-bottom:4px">Ethylene EU</div>
          <div style="font-size:11px;color:var(--ink-soft);line-height:1.5">Spot dropped 3.8% in 4hrs. Percentile moved from 45 â†’ 31. Distribution model now recommends +9% coverage increase.</div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="btn btn-p btn-sm">Execute +9%</button>
            <button class="btn btn-g btn-sm">Dismiss</button>
          </div>
        </div>
        <div class="trigger-active">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">
            <div style="font-size:12px;font-weight:700;color:var(--green)">ğŸŸ¢ WINDOW OPEN</div>
            <div style="font-size:10px;color:var(--ink-soft)">Opened 6h ago</div>
          </div>
          <div style="font-size:14px;font-weight:700;color:var(--ink);margin-bottom:4px">Palm Oil MY</div>
          <div style="font-size:11px;color:var(--ink-soft);line-height:1.5">Satellite imagery shows 8% crop density decline. Spot yet to reprice. Pre-emptive hedge window before market reacts (+24â€“72hrs).</div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="btn btn-p btn-sm">Pre-Hedge</button>
            <button class="btn btn-g btn-sm">Dismiss</button>
          </div>
        </div>
        <div class="trigger-closed">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">
            <div style="font-size:12px;font-weight:700;color:var(--red)">ğŸ”´ WINDOW CLOSED</div>
            <div style="font-size:10px;color:var(--ink-soft)">Closed 1h ago</div>
          </div>
          <div style="font-size:14px;font-weight:700;color:var(--ink);margin-bottom:4px">SMP NZ</div>
          <div style="font-size:11px;color:var(--ink-soft);line-height:1.5">Price rebounded +4.2%. Window that was open yesterday for 6 hours. Missed potential: <span style="color:var(--red);font-weight:600">âˆ’Â£0.18M</span></div>
          <div style="margin-top:10px"><span class="badge badge-red">Regret Logged</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 2: SCORING PROFILES                                                -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view" id="view-profiles">
    <div class="page-title-row">
      <div>
        <div class="page-title">Scoring Profiles</div>
        <div class="page-sub">5-dimensional intelligence engine Â· No CTRM vendor offers this</div>
      </div>
      <button class="btn btn-g" onclick="showView('dashboard')">â† Dashboard</button>
    </div>

    <!-- Score overview strip -->
    <div class="g4" style="margin-bottom:18px">
      <div class="kpi-card" style="border-top:3px solid var(--green)">
        <div class="kpi-label">Portfolio Health Score</div>
        <div class="kpi-val" style="color:var(--green)">84 / 100</div>
        <div style="margin-top:8px"><span class="score-grade grade-a">A Â· Excellent</span></div>
        <div class="kpi-sub" style="margin-top:6px">Coverage + Timing + M2M + Diversification</div>
      </div>
      <div class="kpi-card" style="border-top:3px solid var(--teal)">
        <div class="kpi-label">Hedge Efficiency Score</div>
        <div class="kpi-val" style="color:var(--teal)">79 / 100</div>
        <div style="margin-top:8px"><span class="score-grade grade-b">B+ Â· Strong</span></div>
        <div class="kpi-sub" style="margin-top:6px">Instrument + Timing + Volume + Cost</div>
      </div>
      <div class="kpi-card" style="border-top:3px solid var(--blue)">
        <div class="kpi-label">Decision Quality Score</div>
        <div class="kpi-val" style="color:var(--blue)">71 / 100</div>
        <div style="margin-top:8px"><span class="score-grade grade-b">B Â· Good</span></div>
        <div class="kpi-sub" style="margin-top:6px">AI-override quality Â· 12-month rolling</div>
      </div>
      <div class="kpi-card" style="border-top:3px solid var(--amber)">
        <div class="kpi-label">Behavioral Bias Score</div>
        <div class="kpi-val" style="color:var(--amber)">63 / 100</div>
        <div style="margin-top:8px"><span class="score-grade grade-c">C+ Â· Caution</span></div>
        <div class="kpi-sub" style="margin-top:6px">Loss aversion detected Â· High anchoring</div>
      </div>
    </div>

    <div class="g2" style="margin-bottom:18px">
      <!-- Portfolio Health Score Breakdown -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Portfolio Health Score â€” Breakdown</div>
          <div class="card-sub">Composite of 4 weighted dimensions Â· Updated daily</div>
        </div>
        <div class="score-section">
          <div style="display:flex;align-items:center;gap:20px;margin-bottom:20px">
            <div style="position:relative">
              <canvas id="phs-chart" width="140" height="140"></canvas>
              <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;pointer-events:none">
                <div style="font-family:'DM Serif Display';font-size:26px;color:var(--ink)">84</div>
                <div style="font-size:9px;color:var(--ink-faint);letter-spacing:.06em">HEALTH</div>
              </div>
            </div>
            <div style="flex:1">
              <div class="prog-row" style="margin-bottom:12px">
                <div class="prog-label">Coverage Adequacy</div>
                <div class="prog-bar" style="flex:1"><div class="prog-fill" style="width:93%;background:var(--green)"></div></div>
                <div class="prog-val" style="color:var(--green)">28/30</div>
              </div>
              <div class="prog-row" style="margin-bottom:12px">
                <div class="prog-label">Timing Quality</div>
                <div class="prog-bar" style="flex:1"><div class="prog-fill" style="width:84%;background:var(--teal)"></div></div>
                <div class="prog-val" style="color:var(--teal)">21/25</div>
              </div>
              <div class="prog-row" style="margin-bottom:12px">
                <div class="prog-label">M2M Performance</div>
                <div class="prog-bar" style="flex:1"><div class="prog-fill" style="width:76%;background:var(--blue)"></div></div>
                <div class="prog-val" style="color:var(--blue)">19/25</div>
              </div>
              <div class="prog-row">
                <div class="prog-label">Diversification</div>
                <div class="prog-bar" style="flex:1"><div class="prog-fill" style="width:80%;background:var(--purple)"></div></div>
                <div class="prog-val" style="color:var(--purple)">16/20</div>
              </div>
            </div>
          </div>
          <div class="diff-banner">
            <div class="diff-icon">ğŸ’¡</div>
            <div>
              <div class="diff-title">Category Creator â€” No CTRM Does This</div>
              <div class="diff-text">ION, Brady, AEGIS all show you M2M performance. None compute a composite health score across coverage quality, entry timing percentiles, and instrument diversification simultaneously. This is the first multi-dimensional hedge health metric for CPG procurement.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Buyer Behavioral Fingerprint -->
      <div class="card">
        <div class="card-header" style="display:flex;justify-content:space-between;align-items:flex-start">
          <div>
            <div class="card-title">Buyer Behavioral Fingerprint</div>
            <div class="card-sub">Sarah Chen Â· 127 CRM decisions analyzed</div>
          </div>
          <span class="badge badge-amber">âš  Bias Alert</span>
        </div>
        <div class="score-section">
          <div style="display:flex;gap:20px;align-items:flex-start">
            <div>
              <canvas id="bias-radar" width="150" height="150"></canvas>
            </div>
            <div style="flex:1">
              <div style="font-size:11px;font-weight:600;color:var(--ink-soft);margin-bottom:10px;letter-spacing:.05em;text-transform:uppercase">Detected Cognitive Biases</div>
              <div class="bias-chip">
                <div>
                  <div class="bias-name">Loss Aversion</div>
                  <div style="font-size:10px;color:var(--ink-soft)">Holds coverage too long when losing</div>
                </div>
                <div>
                  <div class="bias-level" style="color:var(--red)">HIGH Â· 78%</div>
                </div>
              </div>
              <div class="bias-chip">
                <div>
                  <div class="bias-name">Anchoring Bias</div>
                  <div style="font-size:10px;color:var(--ink-soft)">Anchors to last-paid price</div>
                </div>
                <div><div class="bias-level" style="color:var(--amber)">MED Â· 67%</div></div>
              </div>
              <div class="bias-chip">
                <div>
                  <div class="bias-name">Overconfidence</div>
                  <div style="font-size:10px;color:var(--ink-soft)">Override rate 23%, win rate 61%</div>
                </div>
                <div><div class="bias-level" style="color:var(--amber)">MED Â· 51%</div></div>
              </div>
              <div class="bias-chip">
                <div>
                  <div class="bias-name">Recency Bias</div>
                  <div style="font-size:10px;color:var(--ink-soft)">Over-weights last 3 months</div>
                </div>
                <div><div class="bias-level" style="color:var(--green)">LOW Â· 29%</div></div>
              </div>
            </div>
          </div>
          <div class="diff-banner" style="margin-top:14px">
            <div class="diff-icon">ğŸ§ </div>
            <div>
              <div class="diff-title">World's First Procurement Behavioral Intelligence Layer</div>
              <div class="diff-text">Every override is recorded and analyzed using behavioral economics frameworks. When you are about to make a decision that matches your historical bias pattern, Veridian flags it in real-time â€” before the CRM vote.</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="g2" style="margin-bottom:18px">
      <!-- Commodity Criticality Matrix -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Commodity Criticality Matrix</div>
          <div class="card-sub">5-dimensional scoring Â· Drives hedge priority allocation</div>
        </div>
        <div style="padding:18px 22px">
          <canvas id="criticality-chart" width="100%" height="220"></canvas>
          <div style="margin-top:14px">
            <div id="criticality-legend" style="display:grid;grid-template-columns:1fr 1fr;gap:6px"></div>
          </div>
          <div class="diff-banner" style="margin-top:12px">
            <div class="diff-icon">ğŸ¯</div>
            <div>
              <div class="diff-title">Hedge Where It Matters Most</div>
              <div class="diff-text">Matrix scores each commodity on COGS impact, volatility, liquidity, forecast accuracy, and supply concentration. Allocates hedging effort automatically â€” stop spending time on low-criticality commodities.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Peer Benchmark -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Anonymous Peer Benchmarking</div>
          <div class="card-sub">vs. 23 CPG peers Â· Data anonymized Â· Sector: FMCG Global</div>
        </div>
        <div style="padding:18px 22px">
          <div style="font-size:11px;font-weight:600;color:var(--ink-soft);margin-bottom:12px;display:flex;gap:16px">
            <div style="display:flex;align-items:center;gap:5px"><div style="width:10px;height:4px;background:var(--teal);border-radius:2px"></div>You</div>
            <div style="display:flex;align-items:center;gap:5px"><div style="width:10px;height:4px;background:var(--ink-ghost);border-radius:2px"></div>Sector Peers</div>
            <div style="display:flex;align-items:center;gap:5px"><div style="width:2px;height:12px;background:var(--ink-soft)"></div>AI Reco</div>
          </div>
          <div id="benchmark-rows"></div>
          <div style="margin-top:16px;padding:12px 14px;background:rgba(59,130,246,.06);border:1px solid rgba(59,130,246,.2);border-radius:10px">
            <div style="font-size:12px;font-weight:600;color:var(--blue);margin-bottom:4px">ğŸ“Š Benchmark Insight</div>
            <div style="font-size:11px;color:var(--ink-soft);line-height:1.55">Peers are <strong>18% better covered</strong> on Dairy vs. your portfolio. For Palm Oil, you are 12% ahead of sector average. Rebalancing Dairy coverage could unlock ~Â£0.8M/yr additional protection.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Regret Engine / Decision Autopsy -->
    <div class="card">
      <div class="card-header" style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="card-title">Regret Engine â€” Decision Autopsy</div>
          <div class="card-sub">Every past CRM decision tracked against AI recommendation Â· Creates accountability + learning loops</div>
        </div>
        <div style="text-align:right">
          <div style="font-size:11px;color:var(--ink-soft)">12-month regret cost</div>
          <div style="font-family:'DM Serif Display';font-size:22px;color:var(--red)">âˆ’Â£0.83M</div>
          <div style="font-size:10px;color:var(--ink-faint)">from AI override decisions</div>
        </div>
      </div>
      <div style="padding:14px 22px">
        <div id="regret-rows"></div>
        <div class="diff-banner" style="margin-top:10px">
          <div class="diff-icon">ğŸ”¬</div>
          <div>
            <div class="diff-title">Zero Competition â€” Decision Autopsy Engine</div>
            <div class="diff-text">Every CTRM records decisions. None of them tell you what those decisions cost. Veridian's Regret Engine compares every override against what the AI recommended, calculates the actual financial outcome difference, and uses it to train your organization's next decision.</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 3: ORACLE ENGINE                                                   -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view" id="view-oracle">
    <div class="page-title-row">
      <div>
        <div class="page-title">ORACLE Engine</div>
        <div class="page-sub">Bayesian parameter optimization Â· NL audit trail Â· IFRS 9 tested Â· Bias-aware recommendations</div>
      </div>
      <button class="btn btn-g" onclick="showView('dashboard')">â† Dashboard</button>
    </div>

    <div id="oracle-loading">
      <div class="float" style="font-size:48px;margin-bottom:20px">â—ˆ</div>
      <div style="font-family:'DM Serif Display';font-size:24px;color:var(--ink);margin-bottom:6px">ORACLE is running</div>
      <div style="font-size:13px;color:var(--ink-soft);margin-bottom:36px">Analyzing 6 commodities Â· 50+ signal streams Â· 340 scenario runs</div>
      <div style="max-width:440px;margin:0 auto" id="oracle-steps"></div>
      <div style="max-width:440px;margin:20px auto 0;height:4px;background:var(--teal-dim);border-radius:2px;overflow:hidden">
        <div id="oracle-progress" style="height:100%;background:linear-gradient(90deg,var(--teal),var(--teal-l));border-radius:2px;width:0;transition:width .7s ease"></div>
      </div>
    </div>

    <div id="oracle-results">
      <!-- Summary -->
      <div class="g3" style="margin-bottom:18px">
        <div class="kpi-card" style="border-top:3px solid var(--green)">
          <div class="kpi-label">Expected M2M Uplift</div>
          <div class="kpi-val" style="color:var(--green)">+Â£4.7M</div>
          <div class="kpi-sub">vs. no-change scenario Â· 12-month</div>
        </div>
        <div class="kpi-card" style="border-top:3px solid var(--teal)">
          <div class="kpi-label">Top Opportunity</div>
          <div class="kpi-val">Ethylene EU</div>
          <div class="kpi-sub">+Â£1.4M potential Â· Window open now</div>
        </div>
        <div class="kpi-card" style="border-top:3px solid var(--purple)">
          <div class="kpi-label">Parameters Auto-Tuned</div>
          <div class="kpi-val" style="color:var(--purple)">4 of 6</div>
          <div class="kpi-sub">Improved M2M by avg +12.3%</div>
        </div>
      </div>

      <!-- Recommendation cards -->
      <div id="oracle-reco-cards" style="display:flex;flex-direction:column;gap:14px"></div>

      <div class="diff-banner" style="margin-top:16px">
        <div class="diff-icon">âš ï¸</div>
        <div>
          <div class="diff-title">Behavioral Warning Active on Ethylene</div>
          <div class="diff-text">AI detects you are about to under-hedge Ethylene relative to its Criticality Score (9.2/10). Historical pattern: you've anchored to the price you paid in Jan 2025 (1,050 USD/ton). Current spot is 1,175 â€” 11.9% higher. Loss aversion bias is likely suppressing your buy signal. The AI still recommends +9% coverage.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 4: COMMODITY DNA / GENOME                                         -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view" id="view-genome">
    <div class="page-title-row">
      <div>
        <div class="page-title">Commodity DNAâ„¢</div>
        <div class="page-sub">SKU-level commodity exposure mapping Â· No CTRM vendor has this for CPG</div>
      </div>
      <button class="btn btn-g" onclick="showView('dashboard')">â† Dashboard</button>
    </div>

    <div class="diff-banner" style="margin-bottom:18px;border-color:var(--border-m)">
      <div class="diff-icon">ğŸ§¬</div>
      <div>
        <div class="diff-title">The Competitive Moat â€” SKU-Level Commodity Intelligence</div>
        <div class="diff-text">ION, Brady, Eka, AEGIS â€” all are built for commodity traders, not CPG procurement. None map your product portfolio's COGS exposure to commodity trees. Veridian does. If palm oil spikes 20%, you see exactly which SKUs are impacted, by how much, and where to pre-hedge.</div>
      </div>
    </div>

    <div class="g-main-l">
      <!-- Product tree -->
      <div>
        <div style="font-size:13px;font-weight:600;color:var(--ink);margin-bottom:12px">Product Exposure Tree</div>
        <div id="genome-tree"></div>
      </div>

      <!-- Impact panel -->
      <div style="display:flex;flex-direction:column;gap:16px">
        <!-- Shock simulator -->
        <div class="card" style="padding:22px">
          <div style="font-family:'DM Serif Display';font-size:16px;color:var(--ink);margin-bottom:4px">COGS Shock Simulator</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-bottom:16px">Select commodity Â· Drag price shock Â· See P&L ripple across SKUs</div>
          <div style="margin-bottom:14px">
            <label style="font-size:11px;font-weight:600;color:var(--ink-soft)">Select Commodity</label>
            <div style="display:flex;gap:6px;margin-top:6px;flex-wrap:wrap" id="genome-commodity-btns"></div>
          </div>
          <div style="margin-bottom:14px">
            <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--ink-soft);margin-bottom:6px">
              <span>Price Shock</span>
              <span id="shock-val-label" style="font-family:'JetBrains Mono';font-weight:600;color:var(--teal)">+20%</span>
            </div>
            <input type="range" id="genome-shock" min="-30" max="50" value="20" oninput="updateGenomeShock(this.value)"/>
            <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--ink-faint);margin-top:4px"><span>-30%</span><span>No Shock</span><span>+50%</span></div>
          </div>
          <div id="genome-impact-bars"></div>
        </div>

        <!-- Synthetic Hedge Constructor -->
        <div class="card" style="padding:22px">
          <div style="font-family:'DM Serif Display';font-size:16px;color:var(--ink);margin-bottom:4px">Synthetic Hedge Constructor</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-bottom:16px">For illiquid commodities â€” AI builds basket hedges from correlated tradeable instruments</div>
          <div style="background:var(--teal-glow);border-radius:10px;padding:12px 14px;margin-bottom:14px">
            <div style="font-size:11px;font-weight:600;color:var(--teal);margin-bottom:2px">Target: NFDM US â€” No liquid futures market</div>
            <div style="font-size:11px;color:var(--ink-soft)">Correlation-optimized basket Â· 94.7% tracking Â· Lower cost than OTC</div>
          </div>
          <div class="synth-component">
            <div class="synth-weight">41%</div>
            <div>
              <div class="synth-name">CME Class III Milk Futures</div>
              <div class="synth-detail">Primary â€” 0.87 corr Â· ICE feed Â· Most liquid proxy</div>
            </div>
            <span class="badge badge-teal">Long</span>
          </div>
          <div class="synth-component">
            <div class="synth-weight">33%</div>
            <div>
              <div class="synth-name">NZD/USD FX Forward</div>
              <div class="synth-detail">Currency â€” NZ dairy export hedge Â· 0.71 corr</div>
            </div>
            <span class="badge badge-blue">Long</span>
          </div>
          <div class="synth-component">
            <div class="synth-weight">26%</div>
            <div>
              <div class="synth-name">SMP NZ Butter Futures</div>
              <div class="synth-detail">Secondary dairy proxy Â· 0.63 corr Â· SGX listed</div>
            </div>
            <span class="badge badge-teal">Long</span>
          </div>
          <div style="margin-top:14px;padding:10px 12px;background:rgba(16,185,129,.07);border:1px solid rgba(16,185,129,.2);border-radius:10px">
            <div style="font-size:11px;font-weight:600;color:var(--green)">Basket efficiency vs. OTC NFDM forward: +22% lower cost Â· +8% better tracking</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 5: SCENARIO ENGINE                                                 -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view" id="view-scenarios">
    <div class="page-title-row">
      <div>
        <div class="page-title">Scenario Engine</div>
        <div class="page-sub">Generative AI stress-testing Â· Tail risk Â· Carbon overlay Â· Pre-emptive positioning</div>
      </div>
      <button class="btn btn-g" onclick="showView('dashboard')">â† Dashboard</button>
    </div>

    <div class="g-main-l">
      <!-- Scenario config -->
      <div style="display:flex;flex-direction:column;gap:12px">
        <div class="card" style="padding:18px">
          <div style="font-size:13px;font-weight:700;color:var(--ink);margin-bottom:12px">Shock Type</div>
          <div id="scenario-selector"></div>
        </div>
        <div class="card" style="padding:18px">
          <div style="font-size:13px;font-weight:700;color:var(--ink);margin-bottom:14px">Shock Intensity</div>
          <input type="range" id="scenario-intensity" min="10" max="100" value="55" oninput="updateScenario(this.value)"/>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--ink-faint);margin-top:6px">
            <span>Mild</span>
            <span id="intensity-label" style="font-family:'JetBrains Mono';font-weight:700;color:var(--teal)">55%</span>
            <span>Severe</span>
          </div>
        </div>
        <!-- Carbon CBAM Overlay -->
        <div class="card" style="padding:18px">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px">
            <div style="font-size:13px;font-weight:700;color:var(--ink)">ğŸŒ¿ Carbon CBAM Overlay</div>
            <span class="badge badge-purple">EU 2026</span>
          </div>
          <div style="font-size:11px;color:var(--ink-soft);margin-bottom:12px;line-height:1.55">EU Carbon Border Adjustment Mechanism now active. Veridian overlays carbon premium costs on commodity imports â€” no competitor has this yet.</div>
          <div id="carbon-rows"></div>
        </div>
      </div>

      <!-- Results panel -->
      <div style="display:flex;flex-direction:column;gap:16px">
        <div class="g2">
          <div class="kpi-card">
            <div class="kpi-label">Portfolio P&L Impact</div>
            <div class="kpi-val" style="color:var(--red)" id="scenario-pnl">âˆ’Â£11.6M</div>
            <div class="kpi-sub">If fully unhedged</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Hedged Savings</div>
            <div class="kpi-val" style="color:var(--green)" id="scenario-savings">+Â£7.7M</div>
            <div class="kpi-sub">At current coverage levels</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Recommended Î” Coverage</div>
            <div class="kpi-val" style="color:var(--teal)" id="scenario-delta">+11%</div>
            <div class="kpi-sub">AI pre-positioning recommendation</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Scenario Probability</div>
            <div class="kpi-val" id="scenario-prob">21%</div>
            <div class="kpi-sub">AI-assessed Â· 12-month horizon</div>
          </div>
        </div>

        <!-- Waterfall impact -->
        <div class="card" style="padding:22px">
          <div style="font-family:'DM Serif Display';font-size:16px;margin-bottom:4px">Commodity Impact Waterfall</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-bottom:16px">P&L impact by commodity under selected scenario</div>
          <canvas id="scenario-chart" height="180"></canvas>
        </div>

        <!-- AI Narrative -->
        <div class="card" style="padding:20px;background:linear-gradient(135deg,var(--teal-glow),var(--surface));border-color:var(--border-m)">
          <div style="font-size:13px;font-weight:700;color:var(--teal);margin-bottom:8px">ğŸ¤– AI Scenario Narrative</div>
          <div id="scenario-narrative" style="font-size:13px;color:var(--ink-mid);line-height:1.7"></div>
          <div class="diff-banner" style="margin-top:12px">
            <div class="diff-icon">ğŸŒ</div>
            <div>
              <div class="diff-title">Generative Scenarios â€” Beyond Historical Backtesting</div>
              <div class="diff-text">Legacy tools backtest what happened. Veridian generates novel shock scenarios using LLM reasoning â€” geopolitical cascades, correlated climate failures, supply concentration domino effects â€” things that have never happened before but could.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- VIEW 6: SIGNAL LAB                                                      -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="view" id="view-signals">
    <div class="page-title-row">
      <div>
        <div class="page-title">Signal Lab</div>
        <div class="page-sub">50+ alternative data streams Â· Real-time triggers Â· Intraday windows Â· Counterparty risk</div>
      </div>
      <button class="btn btn-g" onclick="showView('dashboard')">â† Dashboard</button>
    </div>

    <div class="g2" style="margin-bottom:18px">
      <!-- Signal stream -->
      <div class="card" style="padding:0;overflow:hidden">
        <div class="card-header" style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="card-title">Live Alternative Data Signals</div>
            <div class="card-sub">Satellite Â· AIS shipping Â· Weather Â· Sentiment Â· Central banks</div>
          </div>
          <div class="live-pill"><div class="live-dot"></div><span class="live-txt">Live</span></div>
        </div>
        <div id="full-signal-feed"></div>
      </div>

      <!-- Signal source breakdown -->
      <div style="display:flex;flex-direction:column;gap:14px">
        <div class="card" style="padding:20px">
          <div style="font-family:'DM Serif Display';font-size:16px;margin-bottom:4px">Data Source Coverage</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-bottom:16px">50+ streams across 8 categories</div>
          <canvas id="signal-donut" height="160"></canvas>
          <div id="signal-legend" style="margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:6px"></div>
        </div>

        <!-- Counterparty Risk -->
        <div class="card" style="padding:20px">
          <div style="font-family:'DM Serif Display';font-size:16px;margin-bottom:4px">Counterparty Risk Monitor</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-bottom:14px">EMIR / Dodd-Frank compliance Â· Auto-tested daily</div>
          <div id="counterparty-rows"></div>
          <div class="diff-banner" style="margin-top:10px">
            <div class="diff-icon">ğŸ¦</div>
            <div>
              <div class="diff-title">Counterparty Credit Intelligence</div>
              <div class="diff-text">Unlike CTRM tools that just record counterparties, Veridian monitors their credit default swap spreads, ratings, and exposure concentration in real time.</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Natural Language Policy Enforcer -->
    <div class="card" style="padding:24px">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px">
        <div>
          <div style="font-family:'DM Serif Display';font-size:18px;color:var(--ink)">Natural Language Policy Enforcer</div>
          <div style="font-size:12px;color:var(--ink-soft);margin-top:3px">Enter hedging rules in plain English â€” AI enforces them as hard constraints on every recommendation</div>
        </div>
        <span class="badge badge-purple">CFO-Ready</span>
      </div>
      <div id="policy-rules"></div>
      <div style="margin-top:14px;display:flex;gap:10px;align-items:center">
        <input type="text" id="policy-input" placeholder='e.g. "Never exceed 90% coverage on any single commodity"' style="flex:1;padding:10px 14px;border:1px solid var(--border-m);border-radius:10px;font-family:'DM Sans';font-size:13px;color:var(--ink);background:var(--surface-alt);outline:none"/>
        <button class="btn btn-p" onclick="addPolicy()">Add Rule</button>
      </div>
      <div class="diff-banner" style="margin-top:14px">
        <div class="diff-icon">ğŸ“œ</div>
        <div>
          <div class="diff-title">Zero Competitors â€” NL Policy Enforcement</div>
          <div class="diff-text">Every other tool requires a technical consultant to encode hedging rules as parameters. Veridian lets your CFO type "maximum 80% coverage during earnings lock-up periods" and enforces it automatically across all AI recommendations.</div>
        </div>
      </div>
    </div>
  </section>

  </div><!-- end #content -->
</div><!-- end #main -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const COMMODITIES = [
  {id:'eth',name:'Ethylene',region:'EU',price:1175,unit:'USD/ton',cov:78,signal:'BUY',chg:+2.3,m2m:+1.07,conf:87,spend:28.4,cat:'Petrochem',priority:9.2,spark:[1050,1080,1095,1120,1160,1140,1175]},
  {id:'nfdm',name:'NFDM',region:'US',price:1.19,unit:'USD/lb',cov:82,signal:'BUY',chg:-1.1,m2m:+0.78,conf:91,spend:26.0,cat:'Dairy',priority:8.1,spark:[1.05,1.09,1.12,1.15,1.18,1.17,1.19]},
  {id:'wmp',name:'WMP',region:'EU',price:3230,unit:'USD/MT',cov:65,signal:'HOLD',chg:+0.4,m2m:+0.96,conf:74,spend:22.8,cat:'Dairy',priority:7.4,spark:[2900,2980,3050,3100,3180,3210,3230]},
  {id:'smp',name:'SMP',region:'NZ',price:2787,unit:'USD/MT',cov:54,signal:'BUY',chg:+5.2,m2m:+0.47,conf:68,spend:6.2,cat:'Dairy',priority:6.8,spark:[2400,2550,2620,2700,2750,2760,2787]},
  {id:'palm',name:'Palm Oil',region:'MY',price:4120,unit:'USD/MT',cov:71,signal:'HOLD',chg:-3.4,m2m:+1.34,conf:82,spend:41.2,cat:'Veg Oil',priority:8.7,spark:[3800,3900,4050,4200,4150,4100,4120]},
  {id:'prop',name:'Propylene',region:'EU',price:890,unit:'USD/ton',cov:45,signal:'SELL',chg:-6.1,m2m:-0.23,conf:79,spend:19.6,cat:'Petrochem',priority:5.3,spark:[980,950,930,910,890,895,890]},
];

const SIGNALS_DATA = [
  {type:'SATELLITE',icon:'ğŸ›°',text:'Crop density index for Malaysian palm plantations âˆ’8% MoM. Pre-emptive hedge window: 24â€“72hrs before market reprices.',comm:'Palm Oil',impact:'HIGH',dir:'up',age:'2h ago'},
  {type:'AIS SHIPPING',icon:'ğŸš¢',text:'Red Sea container diversions +34% WoW. Ethylene spot premium expected +8â€“12% within 5 trading days.',comm:'Ethylene',impact:'HIGH',dir:'up',age:'3h ago'},
  {type:'WEATHER',icon:'ğŸŒ¦',text:'La NiÃ±a weakening over NZ â€” Fonterra crop revision expected. WMP forward curve may soften 4â€“6%.',comm:'WMP NZ',impact:'MED',dir:'down',age:'5h ago'},
  {type:'CENTRAL BANK',icon:'ğŸ›',text:'ECB hold confirmed. EUR/USD stable. No FX impact on EUR-denominated dairy hedges.',comm:'All Dairy',impact:'LOW',dir:'neutral',age:'6h ago'},
  {type:'PROXY HEDGE',icon:'ğŸ”—',text:'Naphtha-Propylene spread at 10yr low. Synthetic hedge via Naphtha futures is 37% more efficient than direct Propylene OTC.',comm:'Propylene',impact:'HIGH',dir:'up',age:'8h ago'},
  {type:'SENTIMENT',icon:'ğŸ“Š',text:'Bloomberg Commodity Fund Flow Index: âˆ’$4.2B outflow from agri futures. Short-term price pressure on dairy.',comm:'Dairy',impact:'MED',dir:'down',age:'11h ago'},
  {type:'SUPPLY CHAIN',icon:'ğŸ­',text:'BASF cracker maintenance scheduled Q2. Ethylene supply tightening +3â€“5% expected Mayâ€“June.',comm:'Ethylene',impact:'MED',dir:'up',age:'14h ago'},
  {type:'CARBON CBAM',icon:'ğŸŒ¿',text:'EU CBAM carbon premium for Ethylene imports from non-EU: +â‚¬28/ton. Factor in synthetic routes.',comm:'Ethylene',impact:'MED',dir:'up',age:'1d ago'},
];

const REGRET_DATA = [
  {date:'Nov 2025',comm:'Ethylene',action:'Overrode AI â†’ Reduced coverage to 65%',outcome:'Price rose +14.2%',cost:'-Â£0.31M',won:false},
  {date:'Sep 2025',comm:'Palm Oil',action:'Overrode AI â†’ Held coverage (AI said sell)',outcome:'Price fell âˆ’8.7%',cost:'-Â£0.27M',won:false},
  {date:'Jul 2025',comm:'NFDM US',action:'Overrode AI â†’ Increased to 92%',outcome:'Price rose +6.3% â€” AI was right',cost:'+Â£0.19M',won:true},
  {date:'May 2025',comm:'WMP EU',action:'Overrode AI â†’ Delayed hedge by 3 weeks',outcome:'Price moved +11.1% in 3wks',cost:'-Â£0.24M',won:false},
];

const GENOME_PRODUCTS = [
  {name:'Dettol Liquid',sku:'3.2M units/yr',ingredients:[
    {name:'Ethanol (94%)',pct:32,comm:'Ethylene',exp:'High'},
    {name:'Pine Oil (4%)',pct:8,comm:'Pine Resin',exp:'Med'},
    {name:'PET Bottle',pct:12,comm:'Propylene',exp:'Med'},
  ]},
  {name:'Harpic Toilet Bowl',sku:'2.8M units/yr',ingredients:[
    {name:'HCl Acid (40%)',pct:24,comm:'Chlorine',exp:'Low'},
    {name:'Surfactants (8%)',pct:18,comm:'Ethylene',exp:'High'},
    {name:'HDPE Bottle',pct:10,comm:'Ethylene',exp:'High'},
  ]},
  {name:'Enfamil Formula',sku:'1.9M units/yr',ingredients:[
    {name:'Skim Milk Powder (62%)',pct:62,comm:'NFDM',exp:'High'},
    {name:'Palm Olein (18%)',pct:18,comm:'Palm Oil',exp:'High'},
    {name:'Whey Protein (12%)',pct:12,comm:'WMP',exp:'Med'},
  ]},
  {name:'Finish Dishwash',sku:'4.1M units/yr',ingredients:[
    {name:'Surfactant blend (35%)',pct:35,comm:'Propylene',exp:'Med'},
    {name:'Rinse Aid (15%)',pct:15,comm:'Ethylene',exp:'High'},
    {name:'PP Container',pct:8,comm:'Propylene',exp:'Med'},
  ]},
];

const SCENARIOS = [
  {id:'geo',label:'ğŸŒ Geopolitical Shock',desc:'Red Sea closure, sanctions, supply disruption'},
  {id:'climate',label:'ğŸŒ¦ Climate / La NiÃ±a',desc:'Crop failures, drought, flood disruption'},
  {id:'macro',label:'ğŸ“‰ Macro Downturn',desc:'Recession, rate spike, currency collapse'},
  {id:'supply',label:'ğŸ­ Supply Disruption',desc:'Plant shutdown, labor strike, force majeure'},
];

const POLICIES = [
  {text:'Maximum 85% coverage on any single commodity during earnings black-out periods', active:true},
  {text:'Never hedge Propylene above 70% when futures contango > 8%', active:true},
  {text:'Minimum 50% coverage on all Tier 1 commodities at all times', active:true},
];

const PEERS = [
  {comm:'Dairy (Overall)',you:65,peer:83,reco:80},
  {comm:'Palm Oil',you:71,peer:59,reco:75},
  {comm:'Petrochemicals',you:62,peer:68,reco:70},
  {comm:'Specialty Chem',you:38,peer:44,reco:55},
];

const COUNTERPARTIES = [
  {name:'Goldman Sachs',exposure:'Â£42M',rating:'AAâˆ’',cds:28,risk:'Low'},
  {name:'Deutsche Bank',exposure:'Â£31M',rating:'A+',cds:54,risk:'Medium'},
  {name:'Cargill Risk Mgmt',exposure:'Â£22M',rating:'Aâˆ’',cds:41,risk:'Low'},
  {name:'Macquarie Comm.',exposure:'Â£18M',rating:'BBB+',cds:87,risk:'Medium'},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showView(id){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  const viewEl = document.getElementById('view-'+id);
  if(viewEl){ viewEl.classList.add('active'); document.getElementById('content').scrollTop=0; }
  const navMap={dashboard:0,profiles:1,oracle:2,genome:3,scenarios:4,signals:5};
  const navItems=document.querySelectorAll('.nav-item');
  if(navMap[id]!==undefined) navItems[navMap[id]].classList.add('active');
  if(id==='oracle') runOracle();
  if(id==='scenarios') initScenario();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIDEBAR COMMODITIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildSidebar(){
  const list=document.getElementById('sb-comm-list');
  const sigColors={BUY:'var(--green)',HOLD:'var(--amber)',SELL:'var(--red)'};
  list.innerHTML=COMMODITIES.map(c=>`
    <div class="comm-item" onclick="showView('dashboard')">
      <div class="comm-dot" style="background:${sigColors[c.signal]}"></div>
      <div class="comm-name">${c.name}</div>
      <div class="comm-val" style="font-family:'JetBrains Mono';font-size:10px;color:${sigColors[c.signal]};font-weight:600">${c.cov}%</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD â€” COMMODITY TABLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildCommTable(){
  const table=document.getElementById('comm-table');
  const sigClass={BUY:'badge-buy',HOLD:'badge-hold',SELL:'badge-sell'};
  const sigColors={BUY:'var(--green)',HOLD:'var(--amber)',SELL:'var(--red)'};
  const prioColor=p=>p>=8.5?'var(--red)':p>=7?'var(--amber)':'var(--green)';

  table.innerHTML=COMMODITIES.map(c=>{
    const sparkH=36;const sparkW=60;
    const mn=Math.min(...c.spark),mx=Math.max(...c.spark),rng=mx-mn||1;
    const pts=c.spark.map((v,i)=>`${(i/(c.spark.length-1))*sparkW},${sparkH-((v-mn)/rng)*sparkH}`).join(' ');
    const chgColor=c.chg>0?'var(--green)':'var(--red)';
    const priceDisplay=c.price>10?c.price.toLocaleString():c.price;
    const covColor=c.cov>=75?'var(--green)':c.cov>=60?'var(--amber)':'var(--red)';
    return `
    <div class="tbl-row" style="grid-template-columns:160px 90px 70px 80px 80px 70px 60px" onclick="showView('profiles')">
      <div>
        <div style="font-weight:600;font-size:13px">${c.name}</div>
        <div style="font-size:10px;color:var(--ink-soft)">${c.region} Â· ${c.cat}</div>
      </div>
      <div>
        <div style="font-family:'JetBrains Mono';font-size:13px;font-weight:500">${priceDisplay}</div>
        <div style="font-size:9px;color:var(--ink-faint)">${c.unit}</div>
      </div>
      <div style="font-family:'JetBrains Mono';font-size:12px;font-weight:600;color:${chgColor}">${c.chg>0?'+':''}${c.chg}%</div>
      <div><span class="badge ${sigClass[c.signal]}">${c.signal}</span></div>
      <div style="display:flex;align-items:center;gap:8px">
        <div style="flex:1">
          <div style="height:4px;background:var(--teal-dim);border-radius:2px;overflow:hidden">
            <div style="width:${c.cov}%;height:100%;background:${covColor};border-radius:2px"></div>
          </div>
        </div>
        <span style="font-family:'JetBrains Mono';font-size:11px;font-weight:600;color:${covColor}">${c.cov}%</span>
      </div>
      <div style="font-family:'JetBrains Mono';font-size:12px;font-weight:600;color:${c.m2m>0?'var(--green)':'var(--red)'}">
        ${c.m2m>0?'+':''}Â£${Math.abs(c.m2m)}M
      </div>
      <div style="display:flex;align-items:center;gap:4px">
        <div style="font-family:'JetBrains Mono';font-size:12px;font-weight:700;color:${prioColor(c.priority)}">${c.priority}</div>
      </div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD â€” SIGNAL FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildSignalFeed(containerId,limit){
  const el=document.getElementById(containerId);
  if(!el) return;
  const impactColors={HIGH:'var(--red)',MED:'var(--amber)',LOW:'var(--ink-faint)'};
  const dirIcons={up:'â†‘',down:'â†“',neutral:'â†’'};
  const dirColors={up:'var(--red)',down:'var(--green)',neutral:'var(--ink-faint)'};
  const items=(limit?SIGNALS_DATA.slice(0,limit):SIGNALS_DATA);
  el.innerHTML=items.map(s=>`
    <div class="signal-item">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px">
        <div style="display:flex;align-items:center;gap:6px">
          <span style="font-size:14px">${s.icon}</span>
          <span class="signal-type" style="color:${impactColors[s.impact]}">${s.type}</span>
          <span class="badge badge-teal" style="font-size:9px;padding:2px 6px">${s.comm}</span>
        </div>
        <div style="display:flex;align-items:center;gap:6px">
          <span style="font-size:14px;color:${dirColors[s.dir]};font-weight:700">${dirIcons[s.dir]}</span>
          <span style="font-size:10px;color:var(--ink-faint)">${s.age}</span>
        </div>
      </div>
      <div class="signal-text">${s.text}</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILES â€” PHS CHART (Doughnut)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPHSChart(){
  const ctx=document.getElementById('phs-chart');
  if(!ctx) return;
  new Chart(ctx,{
    type:'doughnut',
    data:{
      datasets:[{
        data:[28,21,19,16,16],
        backgroundColor:['#10B981','#0D9488','#3B82F6','#8B5CF6','#F0FDFA'],
        borderWidth:0,
        circumference:360,
      }]
    },
    options:{plugins:{legend:{display:false},tooltip:{enabled:false}},cutout:'70%',responsive:false}
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILES â€” BIAS RADAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildBiasRadar(){
  const ctx=document.getElementById('bias-radar');
  if(!ctx) return;
  new Chart(ctx,{
    type:'radar',
    data:{
      labels:['Loss\nAversion','Anchoring','Overconf.','Recency','Status\nQuo'],
      datasets:[
        {data:[78,67,51,29,58],backgroundColor:'rgba(239,68,68,.12)',borderColor:'#EF4444',borderWidth:2,pointBackgroundColor:'#EF4444',pointRadius:3},
        {data:[40,40,40,40,40],backgroundColor:'rgba(13,148,136,.06)',borderColor:'rgba(13,148,136,.3)',borderWidth:1.5,pointRadius:0,borderDash:[4,4]}
      ]
    },
    options:{
      responsive:false,
      plugins:{legend:{display:false},tooltip:{enabled:false}},
      scales:{r:{min:0,max:100,ticks:{display:false},grid:{color:'rgba(0,0,0,.06)'},pointLabels:{font:{size:9,family:"'DM Sans'"},color:'#4A6B67'}}}
    }
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILES â€” CRITICALITY BUBBLE CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildCriticalityChart(){
  const ctx=document.getElementById('criticality-chart');
  if(!ctx) return;
  const data={
    datasets:[{
      label:'Commodities',
      data:[
        {x:8.2,y:7.8,r:18},{x:7.1,y:6.4,r:14},{x:6.8,y:5.9,r:10},
        {x:6.2,y:5.1,r:8},{x:8.7,y:8.1,r:20},{x:4.8,y:5.3,r:9}
      ],
      backgroundColor:['rgba(13,148,136,.65)','rgba(13,148,136,.5)','rgba(20,184,166,.5)',
        'rgba(94,234,212,.7)','rgba(239,68,68,.6)','rgba(245,158,11,.6)'],
      borderColor:['#0D9488','#0D9488','#14B8A6','#5EEAD4','#EF4444','#F59E0B'],
      borderWidth:2,
    }]
  };
  new Chart(ctx,{
    type:'bubble',
    data,
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},tooltip:{callbacks:{label:(ctx)=>{
        const names=['Ethylene','NFDM','WMP','SMP','Palm Oil','Propylene'];
        const c=ctx.dataIndex;
        return `${names[c]}: COGS ${ctx.raw.x} Â· Volatility ${ctx.raw.y}`;
      }}}},
      scales:{
        x:{title:{display:true,text:'COGS Impact Score',font:{size:10}},min:3,max:10,grid:{color:'rgba(0,0,0,.04)'}},
        y:{title:{display:true,text:'Volatility Score',font:{size:10}},min:3,max:10,grid:{color:'rgba(0,0,0,.04)'}}
      }
    }
  });

  const legend=document.getElementById('criticality-legend');
  const names=['Ethylene','NFDM','WMP','SMP','Palm Oil','Propylene'];
  const colors=['#0D9488','#0D9488','#14B8A6','#5EEAD4','#EF4444','#F59E0B'];
  legend.innerHTML=names.map((n,i)=>`
    <div style="display:flex;align-items:center;gap:6px;font-size:11px;color:var(--ink-soft)">
      <div style="width:8px;height:8px;border-radius:50%;background:${colors[i]};flex-shrink:0"></div>
      ${n}
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILES â€” PEER BENCHMARK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildBenchmarkRows(){
  const el=document.getElementById('benchmark-rows');
  el.innerHTML=PEERS.map(p=>`
    <div class="bench-row">
      <div class="bench-label">${p.comm}</div>
      <div style="flex:1;position:relative">
        <div class="bench-bar-wrap">
          <div class="bench-bar-peer" style="width:${p.peer}%"></div>
          <div class="bench-bar-you" style="width:${p.you}%"></div>
          <div class="bench-marker" style="left:${p.reco}%"></div>
        </div>
      </div>
      <div class="bench-you-val">${p.you}%</div>
      <div class="bench-peer-val">Peer: ${p.peer}%</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILES â€” REGRET ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildRegretRows(){
  const el=document.getElementById('regret-rows');
  el.innerHTML=REGRET_DATA.map(r=>`
    <div class="decision-row">
      <div class="decision-icon ${r.won?'decision-win':'decision-loss'}">${r.won?'âœ“':'âœ—'}</div>
      <div style="flex:1">
        <div style="font-size:12px;font-weight:600;color:var(--ink)">${r.date} Â· ${r.comm}</div>
        <div style="font-size:11px;color:var(--ink-soft);margin-top:2px">${r.action}</div>
        <div style="font-size:11px;color:var(--ink-soft);margin-top:1px">${r.outcome}</div>
      </div>
      <div class="regret-amount" style="color:${r.won?'var(--green)':'var(--red)'}">${r.cost}</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORACLE ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let oracleRan=false;
function runOracle(){
  if(oracleRan){document.getElementById('oracle-loading').style.display='none';document.getElementById('oracle-results').style.display='block';return;}
  document.getElementById('oracle-loading').style.display='block';
  document.getElementById('oracle-results').style.display='none';

  const steps=[
    {text:'Ingesting CME, ICE, LME live futures feeds...'},
    {text:'Bayesian parameter optimization â€” 340 scenario runs...'},
    {text:'Fusing 50+ alternative data signals (satellite, AIS, weather)...'},
    {text:'Running Synthetic Hedge Constructor for illiquid commodities...'},
    {text:'Checking behavioral bias profile â€” flagging anchoring on Ethylene...'},
    {text:'IFRS 9 hedge effectiveness prospective test...'},
    {text:'Generating natural language audit trail...'},
    {text:'Recommendations ready âœ“'},
  ];

  const stepsEl=document.getElementById('oracle-steps');
  stepsEl.innerHTML=steps.map((s,i)=>`
    <div class="oracle-step" id="oracle-step-${i}" style="opacity:.2">
      <div class="step-icon" id="step-icon-${i}">â—‹</div>
      <div style="flex:1;font-size:12px;color:var(--ink-soft)">${s.text}</div>
      <div class="step-bar" style="width:80px"><div class="step-fill" id="step-fill-${i}"></div></div>
    </div>`).join('');

  let i=0;
  const prog=document.getElementById('oracle-progress');
  const interval=setInterval(()=>{
    if(i>0){
      document.getElementById(`step-icon-${i-1}`).textContent='âœ“';
      document.getElementById(`step-icon-${i-1}`).style.color='var(--green)';
    }
    if(i<steps.length){
      const stepEl=document.getElementById(`oracle-step-${i}`);
      stepEl.style.opacity='1';
      document.getElementById(`step-icon-${i}`).textContent='âŸ³';
      document.getElementById(`step-icon-${i}`).style.color='var(--teal)';
      document.getElementById(`step-fill-${i}`).style.width='100%';
      prog.style.width=`${((i+1)/steps.length)*100}%`;
      i++;
    } else {
      clearInterval(interval);
      setTimeout(()=>{
        document.getElementById('oracle-loading').style.display='none';
        buildOracleResults();
        document.getElementById('oracle-results').style.display='block';
        oracleRan=true;
      },500);
    }
  },680);
}

function buildOracleResults(){
  const el=document.getElementById('oracle-reco-cards');
  const sigClass={BUY:'badge-buy',HOLD:'badge-hold',SELL:'badge-sell'};
  const params=[
    {name:'Backward Window',val:'36mo',old:'24mo',chg:'+12mo',up:true},
    {name:'FC Grid Start',val:'150%',old:'120%',chg:'+30%',up:true},
    {name:'FC Time Decay',val:'10%',old:'15%',chg:'âˆ’5%',up:false},
    {name:'FC Importance',val:'60%',old:'50%',chg:'+10%',up:true},
  ];
  el.innerHTML=COMMODITIES.map((c,ci)=>{
    const newCov=Math.min(93,c.cov+Math.floor(Math.random()*8)+3);
    const delta=newCov-c.cov;
    const mEffect=((delta/100)*c.spend*0.042).toFixed(2);
    const biasWarn=c.id==='eth';
    const ifrsOk=c.id!=='prop';
    return `
    <div class="card" style="padding:0;overflow:hidden;margin-bottom:0">
      <div style="display:grid;grid-template-columns:180px 80px 80px 80px 80px 1fr auto;align-items:center;gap:14px;padding:16px 22px;cursor:pointer;transition:.15s"
           onmouseenter="this.style.background='var(--teal-glow)'" onmouseleave="this.style.background='transparent'">
        <div>
          <div style="font-weight:600;font-size:14px">${c.name} Â· ${c.region}</div>
          <div style="font-size:11px;color:var(--ink-soft)">${c.cat} Â· Priority ${c.priority}</div>
        </div>
        <span class="badge ${sigClass[c.signal]}">${c.signal}</span>
        <div>
          <div style="font-size:10px;color:var(--ink-faint)">Current</div>
          <div style="font-family:'JetBrains Mono';font-size:14px;font-weight:600;color:var(--ink-mid)">${c.cov}%</div>
        </div>
        <div>
          <div style="font-size:10px;color:var(--ink-faint)">AI Reco</div>
          <div style="font-family:'JetBrains Mono';font-size:16px;font-weight:700;color:var(--teal)">${newCov}%</div>
        </div>
        <div>
          <div style="font-size:10px;color:var(--ink-faint)">Î” Impact</div>
          <div style="font-family:'JetBrains Mono';font-size:13px;font-weight:600;color:var(--green)">+Â£${mEffect}M</div>
        </div>
        <div>
          <div style="font-size:10px;color:var(--ink-faint);margin-bottom:4px">AI Confidence</div>
          <div style="display:flex;align-items:center;gap:8px">
            <div style="flex:1;height:4px;background:var(--teal-dim);border-radius:2px;overflow:hidden">
              <div style="width:${c.conf}%;height:100%;background:var(--teal);border-radius:2px"></div>
            </div>
            <span style="font-family:'JetBrains Mono';font-size:11px;font-weight:600;color:var(--teal)">${c.conf}%</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:6px">
          ${biasWarn?'<span class="badge badge-amber" title="Behavioral bias detected">âš  Bias</span>':''}
          ${ifrsOk?'<span class="badge badge-teal">IFRS9 âœ“</span>':'<span class="badge badge-red">IFRS9 !</span>'}
        </div>
      </div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GENOME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildGenomeTree(){
  const el=document.getElementById('genome-tree');
  if(!el) return;
  el.innerHTML=GENOME_PRODUCTS.map((p,pi)=>`
    <div class="gene-product" id="gene-prod-${pi}" onclick="toggleGene(${pi})">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="gene-product-name">${p.name}</div>
          <div style="font-size:11px;color:var(--ink-soft);margin-top:2px">${p.sku}</div>
        </div>
        <span style="font-size:16px;color:var(--teal)" id="gene-arrow-${pi}">â–¸</span>
      </div>
      <div class="gene-ingredients" id="gene-ing-${pi}">
        ${p.ingredients.map(ing=>`
          <div class="gene-ing">
            <div style="padding-left:10px;flex:1">
              <div style="font-size:12px;color:var(--ink-mid);font-weight:500">${ing.name}</div>
              <div class="gene-comm" style="margin-top:4px">
                <span style="font-size:10px;font-weight:700;color:var(--teal)">â†’ ${ing.comm}</span>
                <span class="badge ${ing.exp==='High'?'badge-red':ing.exp==='Med'?'badge-amber':'badge-teal'}" style="font-size:9px;margin-left:auto">${ing.exp} Exp.</span>
              </div>
            </div>
            <div style="text-align:right;padding-right:4px">
              <div style="font-family:'JetBrains Mono';font-size:13px;font-weight:700;color:var(--teal)">${ing.pct}%</div>
              <div style="font-size:9px;color:var(--ink-faint)">of COGS</div>
            </div>
          </div>
        `).join('')}
      </div>
    </div>`).join('');
}

function toggleGene(idx){
  const prod=document.getElementById(`gene-prod-${idx}`);
  const ing=document.getElementById(`gene-ing-${idx}`);
  const arrow=document.getElementById(`gene-arrow-${idx}`);
  const open=ing.classList.toggle('open');
  prod.classList.toggle('open',open);
  arrow.textContent=open?'â–¾':'â–¸';
}

function buildGenomeCommodityBtns(){
  const el=document.getElementById('genome-commodity-btns');
  if(!el) return;
  const comms=['Ethylene','Palm Oil','NFDM','Propylene'];
  el.innerHTML=comms.map((c,i)=>`
    <button class="btn btn-g btn-sm ${i===0?'btn-p':''}" onclick="selectGenomeComm(this,'${c}')">${c}</button>`).join('');
  updateGenomeShock(20);
}

function selectGenomeComm(btn,comm){
  document.querySelectorAll('#genome-commodity-btns .btn').forEach(b=>{b.classList.remove('btn-p');b.classList.add('btn-g')});
  btn.classList.add('btn-p');btn.classList.remove('btn-g');
  updateGenomeShock(document.getElementById('genome-shock').value);
}

function updateGenomeShock(val){
  const pct=parseInt(val);
  document.getElementById('shock-val-label').textContent=`${pct>0?'+':''}${pct}%`;
  const skus=['Dettol Liquid','Harpic Toilet Bowl','Enfamil Formula','Finish Dishwash'];
  const impacts=[pct*0.32, pct*0.18, pct*0.12, pct*0.35];
  const el=document.getElementById('genome-impact-bars');
  el.innerHTML=skus.map((s,i)=>{
    const imp=(impacts[i]).toFixed(1);
    const color=pct>0?'var(--red)':'var(--green)';
    const barW=Math.min(100,Math.abs(impacts[i])*2.5);
    return `
    <div style="margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:4px">
        <span style="color:var(--ink-mid);font-weight:500">${s}</span>
        <span style="font-family:'JetBrains Mono';font-weight:700;color:${color}">${pct>0?'+':''}${imp}% COGS</span>
      </div>
      <div style="height:6px;background:var(--teal-dim);border-radius:3px;overflow:hidden">
        <div style="width:${barW}%;height:100%;background:${color};border-radius:3px;transition:width .5s"></div>
      </div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCENARIO ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let scenarioChart=null;
let activeScenario='geo';
function initScenario(){
  const el=document.getElementById('scenario-selector');
  if(el.innerHTML) return;
  el.innerHTML=SCENARIOS.map(s=>`
    <div class="scenario-card ${s.id==='geo'?'active':''}" id="sc-${s.id}" onclick="selectScenario('${s.id}',this)">
      <div class="scenario-title">${s.label}</div>
      <div class="scenario-desc">${s.desc}</div>
    </div>`).join('');
  buildCarbonRows();
  buildScenarioChart(55);
  updateScenario(55);
}

function selectScenario(id,el){
  document.querySelectorAll('.scenario-card').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');activeScenario=id;
  updateScenario(document.getElementById('scenario-intensity').value);
}

function updateScenario(val){
  const pct=parseInt(val);
  document.getElementById('intensity-label').textContent=`${pct}%`;
  document.getElementById('scenario-pnl').textContent=`âˆ’Â£${(pct*0.211).toFixed(1)}M`;
  document.getElementById('scenario-savings').textContent=`+Â£${(pct*0.14).toFixed(1)}M`;
  document.getElementById('scenario-delta').textContent=`+${Math.min(18,Math.round(pct/6))}%`;
  document.getElementById('scenario-prob').textContent=`${Math.round(pct*0.38)}%`;
  const narratives={
    geo:`A <strong>${pct>60?'severe':'moderate'} geopolitical shock</strong> at ${pct}% intensity would cascade through Ethylene (via Red Sea closures) and Palm Oil (MY supply routes). Portfolio is ${pct>70?'critically exposed':'partially protected'}. Pre-position Ethylene to 87%+ before next CRM session. Propylene natural hedge via Naphtha should be executed immediately.`,
    climate:`La NiÃ±a intensification at ${pct}% severity would hit NZ dairy hard â€” SMP and WMP spot premiums expected +${Math.round(pct*0.12)}%. Current 54% SMP coverage leaves Â£${(pct*0.05).toFixed(1)}M exposed. Satellite crop data confirms 8-week lead time available for pre-hedge.`,
    macro:`A macro downturn at ${pct}% severity typically sees commodity funds de-lever â€” short-term spot pressure creates buying windows. Counter-intuitively, ${pct>60?'aggressive':'moderate'} pre-buying is recommended for Ethylene and Palm Oil before supply-driven recovery.`,
    supply:`Supply disruption at ${pct}% intensity (plant outage, strike) would tighten Ethylene 3-5% in <72hrs. Synthetic hedge via Naphtha futures provides ${Math.round(pct*0.37)}% cost savings vs. emergency OTC buying under stress. Execute now.`
  };
  document.getElementById('scenario-narrative').innerHTML=narratives[activeScenario]||'';
  buildScenarioChart(pct);
}

function buildScenarioChart(pct){
  const ctx=document.getElementById('scenario-chart');
  if(!ctx) return;
  if(scenarioChart){scenarioChart.destroy();}
  const labels=['Ethylene','Palm Oil','SMP NZ','WMP EU','NFDM','Propylene'];
  const unhedged=[pct*0.092,pct*0.31,-pct*0.04,pct*0.22,pct*0.024,-pct*0.06].map(v=>+(v).toFixed(1));
  const hedged=unhedged.map(v=>+(v*0.35).toFixed(1));
  scenarioChart=new Chart(ctx,{
    type:'bar',
    data:{
      labels,
      datasets:[
        {label:'Unhedged Loss',data:unhedged,backgroundColor:'rgba(239,68,68,.6)',borderRadius:4},
        {label:'After Hedge',data:hedged,backgroundColor:'rgba(13,148,136,.65)',borderRadius:4},
      ]
    },
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{position:'top',labels:{font:{size:10},boxWidth:10}}},
      scales:{x:{grid:{display:false}},y:{title:{display:true,text:'Â£M P&L Impact',font:{size:10}},grid:{color:'rgba(0,0,0,.04)'}}}
    }
  });
}

function buildCarbonRows(){
  const el=document.getElementById('carbon-rows');
  if(!el) return;
  const data=[
    {comm:'Ethylene',import:'Non-EU',carbon:'â‚¬28/ton',impact:'HIGH',adj:'+2.4%'},
    {comm:'Palm Oil',import:'MY/ID',carbon:'â‚¬14/ton',impact:'MED',adj:'+0.8%'},
    {comm:'NFDM',import:'US',carbon:'â‚¬6/ton',impact:'LOW',adj:'+0.3%'},
  ];
  el.innerHTML=data.map(d=>`
    <div class="carbon-chip">
      <div>
        <div style="font-size:12px;font-weight:600;color:var(--ink)">${d.comm}</div>
        <div style="font-size:10px;color:var(--ink-soft)">${d.import} imports</div>
      </div>
      <div style="text-align:right">
        <div class="carbon-val" style="color:var(--purple)">${d.carbon}</div>
        <div class="carbon-impact" style="background:${d.impact==='HIGH'?'rgba(239,68,68,.1)':d.impact==='MED'?'rgba(245,158,11,.1)':'rgba(16,185,129,.1)'};color:${d.impact==='HIGH'?'var(--red)':d.impact==='MED'?'var(--amber)':'var(--green)'}">
          ${d.adj} cost adj.
        </div>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIGNALS â€” Full feed + Donut + Counterparty
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let signalDonutBuilt=false;
function buildSignalDonut(){
  const ctx=document.getElementById('signal-donut');
  if(!ctx||signalDonutBuilt) return;
  signalDonutBuilt=true;
  new Chart(ctx,{
    type:'doughnut',
    data:{
      labels:['Satellite','AIS Shipping','Weather','Macro/CB','Social Sentiment','Proxy Hedge','Supply Chain','Carbon/ESG'],
      datasets:[{
        data:[8,7,9,6,7,5,8,6],
        backgroundColor:['#0D9488','#14B8A6','#5EEAD4','#A7F3D0','#FCD34D','#8B5CF6','#3B82F6','#10B981'],
        borderWidth:0,
      }]
    },
    options:{plugins:{legend:{display:false}},cutout:'55%',responsive:true,maintainAspectRatio:true}
  });
  const legend=document.getElementById('signal-legend');
  const cats=[
    ['Satellite','#0D9488'],['AIS Shipping','#14B8A6'],['Weather','#5EEAD4'],['Macro/CB','#A7F3D0'],
    ['Sentiment','#FCD34D'],['Proxy Hedge','#8B5CF6'],['Supply Chain','#3B82F6'],['Carbon/ESG','#10B981']
  ];
  legend.innerHTML=cats.map(([l,c])=>`
    <div style="display:flex;align-items:center;gap:5px;font-size:10px;color:var(--ink-soft)">
      <div style="width:7px;height:7px;border-radius:50%;background:${c};flex-shrink:0"></div>${l}
    </div>`).join('');
}

function buildCounterpartyRows(){
  const el=document.getElementById('counterparty-rows');
  if(!el||el.innerHTML) return;
  el.innerHTML=COUNTERPARTIES.map(cp=>`
    <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)">
      <div>
        <div style="font-size:12px;font-weight:600;color:var(--ink)">${cp.name}</div>
        <div style="font-size:10px;color:var(--ink-soft)">${cp.exposure} exposure Â· ${cp.rating}</div>
      </div>
      <div style="text-align:right">
        <div style="font-family:'JetBrains Mono';font-size:11px;color:${cp.risk==='Low'?'var(--green)':'var(--amber)'}">CDS: ${cp.cds}bps</div>
        <span class="badge ${cp.risk==='Low'?'badge-buy':'badge-hold'}" style="font-size:9px">${cp.risk} Risk</span>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POLICIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPolicies(){
  const el=document.getElementById('policy-rules');
  if(!el) return;
  renderPolicies();
}
function renderPolicies(){
  const el=document.getElementById('policy-rules');
  el.innerHTML=POLICIES.map((p,i)=>`
    <div style="display:flex;align-items:flex-start;gap:10px;padding:10px 14px;background:${p.active?'rgba(13,148,136,.06)':'rgba(0,0,0,.02)'};border:1px solid ${p.active?'rgba(13,148,136,.22)':'var(--border)'};border-radius:10px;margin-bottom:8px">
      <span style="font-size:14px;margin-top:1px">${p.active?'âœ…':'â¬œ'}</span>
      <div style="flex:1;font-size:12px;color:var(--ink-mid);line-height:1.5">${p.text}</div>
      <div style="display:flex;gap:6px">
        <span class="badge badge-teal" style="font-size:9px">Active</span>
        <span class="badge badge-blue" style="font-size:9px">Enforced</span>
      </div>
    </div>`).join('');
}
function addPolicy(){
  const input=document.getElementById('policy-input');
  if(!input.value.trim()) return;
  POLICIES.push({text:input.value.trim(),active:true});
  input.value='';
  renderPolicies();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIGNALS VIEW â€” lazy init
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const origShowView=showView;
document.querySelectorAll('.nav-item').forEach((el,i)=>{
  el.addEventListener('click',function(){
    const views=['dashboard','profiles','oracle','genome','scenarios','signals'];
    if(views[i]==='signals'){
      setTimeout(()=>{
        buildSignalDonut();
        buildCounterpartyRows();
        buildSignalFeed('full-signal-feed');
        buildPolicies();
      },50);
    }
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded',()=>{
  buildSidebar();
  buildCommTable();
  buildSignalFeed('signal-feed',5);
  // Profiles charts
  setTimeout(()=>{
    buildPHSChart();
    buildBiasRadar();
    buildCriticalityChart();
    buildBenchmarkRows();
    buildRegretRows();
  },100);
  buildGenomeTree();
  buildGenomeCommodityBtns();
});

// Re-init charts when switching to profiles tab (they may be hidden on first render)
document.querySelectorAll('.nav-item').forEach((el,i)=>{
  el.addEventListener('click',function(){
    const views=['dashboard','profiles','oracle','genome','scenarios','signals'];
    if(views[i]==='profiles'){
      setTimeout(()=>{
        buildPHSChart();
        buildBiasRadar();
        buildCriticalityChart();
        buildBenchmarkRows();
        buildRegretRows();
      },60);
    }
    if(views[i]==='genome'){
      setTimeout(()=>{buildGenomeTree();buildGenomeCommodityBtns();},60);
    }
  });
});
</script>
</body>
</html>
